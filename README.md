# Profile-pub

Projekt został stworzony z myślą o umożliwieniu analizy wybrzeży morskich na podstawie ...[Paweł T.]

## generator-py

The main task of the program is to generate elevation profiles of the shore based on the digital elevation model (DEM) and the given line of the shoreline. The resulting profiles can then be further analyzed (e.g., using the analyzer-py library).

The program is executed in several stages. In the first step, transect lines are generated, perpendicular to the given coastline (input shp file). The distances between transects as well as their lengths are set in the configuration file. The next step is to trim the DEM file to the generated transects, taking into account some preset buffer around them. The resulting smaller DEM files are used to create elevation and slope profiles. The profiles are further trimmed to a preset area, which should be provided as an input shp file.

The final results and as well as all intermediate results are saved. Those that can be used, for example, by analyzer-py or click-the-coast-js in the form of separate files (separate directory structure), part in the GeoPackage database.

### input data

1. Numerical model of coastal height (DEM in geotif format).
2. Shoreline (linestring in shp format).
3. Bounding of the area for analysis (polygon in shp format).

### output data 

In addition to the data available in the GeoPackage database (transects, profiles, etc.), the program also saves in the form of separate files:

1. numerical elevation models trimmed to transects (DEM in geotif format).
2. profiles, whole and trimmed to the set area (tables in csv format).
3. bbox data and profiles for visualization in click-the-coast-js application (geojson files)

### configuration

The default configuration of the program can be changed by editing the generator-py/config.json file. Among other things, we can specify:
- directory paths for input data,
- directory paths for output data,
- the path to the database,
- parameters of generated transects,
- parameters of layers in the database, etc.

## analyzer-py

The analyzer-py library is a small collection of Python language functions designed to determine the basic characteristics of coastal profiles. Among other things, we have the ability to determine the slope or volume of the coast at a given section of the given profile (the use of the function is demonstrated in the example analyzer-py/test_meassurement.py). The main purpose of the library, however, is to provide two methods for determining the base and the top of a coastline (such as a dune or cliff) from a elevation profile. Two methods were used for this purpose (the first one was slightly modified):

1. ...

2. ...

Determining the base and top of the coast using both methods is demonstrated in the analyzer-py/test_main_points.py example

The analysis is performed on the basis of the height profile. In both examples, the input data are csv files generated by the generator-py program. To check the format of the input and output data, analyze the example files.

## click-the-coast-js

The default use of the program allows teamwork through the website. On the client side, the orthophotomap with the selected profile and the elevation profile itself (cut) are displayed. This allows to indicate the base and top of the coast while observing both the terrain on the orthophotomap and the profile itself.

The marked characteristic points of each profile (base and top) are saved in the postgresql database by default, and the process itself is performed on the server side using PHP language. The program writes data to the postgresql database by default using PHP pg_connect. The connection is defined in the $conn variable.

For local operation, the server can be installed using, for example, the XAMPP application.

You can also define another connection to any database using, for example, PHP PDO.
A table with the following structure is required to work (example for postgresql):
CREATE TABLE public.dunes (
    "id" serial4 NOT NULL,  
    "profile" varchar NULL,
    "email" varchar NULL,
    "id_user" varchar NULL,
    "time" timestamp NULL DEFAULT now(),  
    "ax" float4 NULL,
    "ay" float4 NULL,
    "bx" float4 NULL,
    "by" float4 NULL,
    CONSTRAINT wydmy_pk PRIMARY KEY (id)
);

### input data

1. Directory with geojson files describing each profile (structure and file names in sample data, name must begin with profile number)

2. Directory with geojson files describing the bbox for each profile (file names same as in the previous section, only suffix _bbox appears).

3. File with profile names.

The input data can be generated using the generator-py program

### output data

The output data (points on the profile) is placed in the postgresql database, as described earlier. 

### configuration

The default configuration can be changed by editing the click-the-coast-js/scripts/config.js file. Among other things, you can set in it:
- path to the directory with profiles,
- path to the directory with bbox files,
- path to the file with profile names,
- map parameters,
etc.